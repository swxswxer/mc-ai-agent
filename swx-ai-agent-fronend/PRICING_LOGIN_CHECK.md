# 定价页面登录检查功能

## 功能说明

为定价页面添加了登录状态检查，确保只有登录用户才能进行订阅操作，与体验页面的保护机制保持一致。

## 实现内容

### 1. 登录状态检查

在所有订阅相关操作前添加登录状态验证：

```javascript
// 检查登录状态
if (!userStore.isLoggedIn) {
  ElMessage.warning('请先登录')
  router.push('/auth')
  return
}
```

### 2. 修改的功能点

#### FREE方案 - "立刻体验"按钮
- **登录前**: 显示"登录后体验"，点击跳转到登录页面
- **登录后**: 显示"立刻体验"，点击跳转到体验页面

#### PRO方案 - "立即订阅"按钮  
- **登录前**: 显示"登录后订阅"，点击跳转到登录页面
- **登录后**: 显示"立即订阅"，点击弹出支付弹窗

#### ULTRA方案 - "立即订阅"按钮
- **登录前**: 显示"登录后订阅"，点击跳转到登录页面  
- **登录后**: 显示"立即订阅"，点击弹出支付弹窗

### 3. 用户体验优化

1. **按钮文本动态显示**：根据登录状态显示不同的按钮文本
2. **统一的提示信息**：使用与体验页面相同的"请先登录"提示
3. **自动跳转**：未登录用户点击后自动跳转到登录页面

## 技术实现

### 导入用户状态管理
```javascript
import { useUserStore } from '../stores/user'
const userStore = useUserStore()
```

### 按钮文本动态绑定
```vue
{{ userStore.isLoggedIn ? '立即订阅' : '登录后订阅' }}
```

### 登录检查函数
```javascript
const subscribe = (vipLevel) => {
  // 检查登录状态
  if (!userStore.isLoggedIn) {
    ElMessage.warning('请先登录')
    router.push('/auth')
    return
  }
  // ... 其余订阅逻辑
}
```

## 测试场景

### 未登录状态测试
1. 访问定价页面
2. 确认所有按钮显示为"登录后XXX"
3. 点击任意按钮
4. 验证是否显示"请先登录"提示
5. 验证是否跳转到登录页面

### 已登录状态测试  
1. 登录用户
2. 访问定价页面
3. 确认所有按钮显示为正常文本
4. 点击FREE方案按钮，验证跳转到体验页面
5. 点击PRO/ULTRA按钮，验证弹出支付弹窗

### 状态切换测试
1. 在定价页面登录/退出
2. 验证按钮文本是否实时更新
3. 验证点击行为是否正确切换

## 与体验页面的一致性

- ✅ 相同的登录检查逻辑
- ✅ 相同的提示信息："请先登录"  
- ✅ 相同的跳转行为：跳转到 `/auth` 页面
- ✅ 相同的用户体验流程

## 修改文件

- `src/views/Pricing.vue` - 添加登录检查和动态按钮文本

## 注意事项

1. 登录检查在每个订阅操作的最开始执行
2. 保持了原有的所有功能逻辑不变
3. 提升了用户体验，避免未登录用户的困惑
4. 与整个应用的权限控制策略保持一致 